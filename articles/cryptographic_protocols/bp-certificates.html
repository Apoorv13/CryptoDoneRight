<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Certificates!</title>
    <meta name="robots" content="noindex, noarchive, nofollow">
    <link rel="stylesheet" href="http://www.cisco.com/etc/designs/cdc/clientlibs/responsive/css/cisco-sans.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="shortcut icon" href="lock-icon.ico">

    <!-- <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700,300' rel='stylesheet' type='text/css'> -->

    <!-- Animate.css -->
    <link rel="stylesheet" href="../../css/animate.css">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="../../css/icomoon.css">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="../../css/bootstrap.css">
    <!-- Superfish -->
    <link rel="stylesheet" href="../../css/superfish.css">

    <!--<link rel="stylesheet" href="../../css/style.css">-->


    <!-- Modernizr JS -->
    <script src="../../js/modernizr-2.6.2.min.js"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
    <script src="js/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="../../css/style-mockup1.css" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  </head>

  <body background>
    <div id="header">
      <header id="fh5co-header-section">
        <div class="container">
          <div class="nav-header">
            <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
            <h1 id="fh5co-logo"><a href="..\..\index.html"><strong><font color="white">Crypto Done Right!</font></strong></a></h1>
            <!-- START #fh5co-menu-wrap -->
            <nav id="fh5co-menu-wrap" role="navigation">
              <ul class="sf-menu" id="fh5co-primary-menu">
                <!--<li class="active">
                  <a href="index.html"><font color="black">Home</font></a>
                </li>-->
                <li>
                  <a href="..\..\articles\cryptographic_protocols\cryptographic-protocols.html" class="fh5co-sub-ddown"><font color="white">Cryptographic Protocols</font></a>
                  <ul class="fh5co-sub-menu">
                    <li><a href="..\..\articles\cryptographic_protocols\basics.html" ><font color="black">Basics</font></a></li>
                    <li><a href="#" class="fh5co-sub-ddown">SSL</a>
                        <ul class="fh5co-sub-menu">
                          <li><a href="..\..\articles\cryptographic_protocols\ssl-2.html">SSL 2.0</a></li>
                          <li><a href="..\..\articles\cryptographic_protocols\ssl-3.html">SSL 3.0</a></li>
                        </ul>
                    </li>
                    <li><a href="#" class="fh5co-sub-ddown">TLS</a>
                        <ul class="fh5co-sub-menu">
                          <li><a href="..\..\articles\cryptographic_protocols\tls-1.html">TLS 1.0</a></li>
                          <li><a href="..\..\articles\cryptographic_protocols\tls-1-1.html" >TLS 1.1</a></li>
                          <li><a href="..\..\articles\cryptographic_protocols\tls-1-2.html" >TLS 1.2</a></li>
                          <li><a href="..\..\articles\cryptographic_protocols\tls-1-3.html" >TLS 1.3</a></li>
                        </ul>
                    </li>
                    <li><a href="#" class="fh5co-sub-ddown">SSH</a>
                        <ul class="fh5co-sub-menu">
                          <li><a href="..\..\articles\cryptographic_protocols\sshv1.html" >SSH 1.0</a></li>
                          <li><a href="..\..\articles\cryptographic_protocols\sshv2.html" >SSH 2.0</a></li>
                        </ul>
                    </li>
                  </ul>
                </li>

                <li>
                  <a href="..\..\articles\cryptographic_protocols\encryption.html" class="fh5co-sub-ddown"><font color="white">Encryption</font></a>
                  <ul class="fh5co-sub-menu">
                    <li><a href="..\..\articles\cryptographic_protocols\encryption.html" ><font color="black">Introduction</font></a></li>
                      <li><a href="#" class="fh5co-sub-ddown">AES</a>
                        <ul class="fh5co-sub-menu">
                          <li><a href="..\..\articles\cryptographic_protocols\aes.html" >Introduction</a></li>
                          <li><a href="..\..\articles\cryptographic_protocols\aes-ctr.html" >AES CTR</a></li>
                          <li><a href="..\..\articles\cryptographic_protocols\aes-cbc.html" >AES CBC</a></li>
                          <li><a href="..\..\articles\cryptographic_protocols\aes-gcm.html">AES GCM</a></li>
                        </ul>
                      </li>
                    <li><a href="#" class="fh5co-sub-ddown">DES</a></li>
                    <li><a href="..\..\articles\cryptographic_protocols\3des.html" class="fh5co-sub-ddown">3DES</a></li>
                  </ul>
                </li>

                <li>
                  <a href="#" class="fh5co-sub-ddown"><font color="white">Hashing Algorithms</font></a>
                   <ul class="fh5co-sub-menu">
                    <li><a href="..\..\articles\hashing_algorithms\example_index.html">Introduction</a></li>
                    <li>
                      <a href="#" class="fh5co-sub-ddown">Hash Functions</a>
                      <ul class="fh5co-sub-menu">
                          <li><a href="#" class="fh5co-sub-ddown">Unkeyed</a>
                        <ul class="fh5co-sub-menu">
                          <li><a href="..\..\articles\hashing_algorithms\md5.html" >MD5</a></li>
                          <li><a href="..\..\articles\hashing_algorithms\sha1.html" >SHA-1</a></li>
                          <li><a href="..\..\articles\hashing_algorithms\sha2.html" >SHA-2</a></li>
                          <li><a href="..\..\articles\hashing_algorithms\sha3.html" >SHA-3</a></li>
                        </ul>
                        </li>
                          <li><a href="#" class="fh5co-sub-ddown">Keyed</a>
                        <ul class="fh5co-sub-menu">
                          <li><a href="http://freehtml5.co/preview/?item=build-free-html5-bootstrap-template" tar
                                 ="_blank">More to come..</a></li>
                            </ul>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </li>
                <li><a href="..\..\about.html"><font color="white">About</font></a></li>
                <li><a href="..\..\contact.html"><font color="white">Contact</font></a></li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
    </div>

    <div class="breadcrumbs">
      <ol class="breadcrumb">
         <li class="breadcrumb-item level"><a href="../../index.html">Home</a></li>
         <li class="breadcrumb-item level"><a href="../articles.html">Articles</a></li>
         <li class="breadcrumb-item level"><a href="cryptographic-protocols.html">Cryptographic Protocols</a></li>
         <li class="breadcrumb-item level0"><a href="basics.html">Basics</a></li>
         <li class="breadcrumb-item level1 active">Best Practices: Certificates</li>
       </ol>
    </div>

<div id="contentScroller">
      <strong style="font-size:1.5vw;">Content</strong> <br />
      <ul>
    <a href="#pkey"><li>
          Use 2048-Bit Private Keys
    </li></a> <br />
		<a href="#protect"><li>
          Protect Private Keys
    </li></a> <br />
		<a href="#hostname"><li>
          Ensure Hostname Coverage
		 </li></a> <br />
    <a href="#reliableCA"><li>
          Obtain Certificates from a Reliable CA
     </li></a> <br />
    <a href="#signature_algo"><li>
          Use Strong Certificate Signature Algorithms
     </li></a> <br />
    <a href="#cert_chain"><li>
          Use Complete Certificate Chains
     </li></a>
      </ul>
    </div>

	<!--	<div class="alert alert-warning">
      Please <strong> DO NOT </strong> roll your own Crypto! Use standard services and libraries.
    </div>-->
  <a href="#"><div class="alert alert-danger">
      <strong>If you have certificate with a SHA1 Signature, Please immediately request for a new certificate with SHA256 Signature.</strong>
    </div></a>

  <a href="flaw-categories.html"><div class="alert alert-warning">
      <strong>Background Reading:</strong> Understanding Different Types of Problems in Crypto.
    </div></a>

    <div class="container-fluid">
      <div class="row" style="padding: 2vw;">

<p id="keyncert">
  <div class="col-md-12 col-sm-12 col-xs-12">

        <h2> <img src="../../images/configuration.jpg " style="width:120px;height:100px;" /> Private Key and Certificates</h2>

        <!-- <font size="4"><strong>Concept:</strong></font>  Use 2048-Bit Private Keys <br /> -->

        Unfortunately, Keys and Certificate come hand-in-hand.

        In TLS or SSL, all security starts with the server's cryptographic identity; a strong private key is needed to prevent attackers from carrying out impersonation attacks. Equally important is to have a valid and strong certificate, which grants the private key the right to represent a particular hostname. Without these two fundamental building blocks, nothing else can be secure. <br /> <br />

        In short, the only thing that validates a server's identity is a server's certificate and its private key. <br /> <br />

        <ul>
        <p id="pkey">
        <li><font size="3"><strong>Use 2048-Bit Private Keys</strong></font> <br /> <br />
        For most web sites or servers, <span class="green">security provided by 2,048-bit RSA keys is sufficient.</span> The RSA public key algorithm is widely supported, which makes keys of this type a safe default choice. <br /><br />

        Ideally, <span class="red">a larger key size doesnt scale very well and are noticeably more slower.</span> If better security than a 2048-bit key is needed, it is <span class="green">recommended to use <a href= "https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm">ECDSA keys (Elliptic Curve Digital Signature Algorithm)</a> </span> since the trade-off of performance vs security is better. <br /><br />

		The utility "openssl" is used to generate the key and CSR. This utility comes with the OpenSSL package and is usually installed under /usr/local/ssl/bin.
		If the utility was installed elsewhere, these instructions will need to be adjusted accordingly.<br /><br />

		Type the following command at the prompt:<br/>

		<ul>
		<li>
		Linux / Unix servers:
		<pre>
		<code>
		openssl genrsa -des3 -out <private-key-file-name.key> 2048 </code>
		</pre>
		</li>
		<li>
		Windows servers:<br />
		<pre>
		<code>
		openssl genrsa -out <private-key-file-name.key>  2048
		</code>
        </li></ul><br /><br />

		The above command generates a 2048 bit RSA private key and stores it in the file privatekey.key. <br /><br />
		<blockquote>
		<b>NOTE</b>: When prompted for a pass phrase, enter a secure pass phrase and remember it, as this pass phrase protects the private key.  If the pass phrase is ever lost a new private key & CSR must be generated and the certifiate reissued.
		</blockquote>
        </p>

        <p id="protect">
        <br /><br />
        <li> <font size="3"><strong>Protect Private Keys</strong></font> <br /> <br />
          <strong>Treat your private keys as an important asset</strong>, restricting access to the smallest possible group of employees while still keeping your arrangements practical. Recommended policies include the following:

          <ul>
            <br />
            <li>
              Generate private keys on a trusted computer with sufficient entropy. <span class="red">Some CAs offer to generate private keys for you; run away from them.</span>
            </li>
            <br />
            <li>
              Password-protect keys from the start to prevent compromise when they are stored in backup systems. Private key passwords don’t help much in production because a knowledgeable attacker can always retrieve the keys from process memory. <i>There are hardware devices (called Hardware Security Modules, or HSMs) that can protect private keys even in the case of server compromise, but they are expensive and thus justifiable only for organizations with strict security requirements.</i>
            </li>
            <br />
            <li>
              After compromise, revoke old certificates and generate new keys.
            </li>
            <br />
            <li>
              <span class="green">Renew certificates yearly,</span> and more often if you can automate the process. Most sites should assume that a compromised certificate will be impossible to revoke reliably; certificates with shorter lifespans are therefore more secure in practice.
            </li>
            <br />
            <li>
              Unless keeping the same keys is important for public key pinning, you should also generate new private keys whenever you're getting a new certificate.
            </li>
          </ul>
        </li>
        </p>

        <p id="hostname">
        <br /><br />
        <li> <font size="3"><strong>Ensure Sufficient Hostname Coverage</strong></font> <br /> <br />

          Ensure that your certificates cover all the names you wish to use with a site. Your goal is to avoid invalid certificate warnings, which confuse users and weaken their confidence. <br /> <br />

          <blockquote>
            <strong> Important </strong> <br /> <br />
          Even when you expect to use only one domain name, remember that you cannot control how your users arrive at the site or how others link to it. In most cases, you should ensure that the certificate works with and without the www prefix (e.g., that it works for both example.com and www.example.com). The rule of thumb is that a secure web server should have a certificate that is valid for every DNS name configured to point to it.
          </blockquote>
          <br />
          <span class="red"> Wildcard certificates have their uses, but avoid using them if it means exposing the underlying keys to a much larger group of people, </span> and especially if doing so crosses team or department boundaries. In other words, the fewer people there are with access to the private keys, the better. Also be aware that certificate sharing creates a bond that can be abused to transfer vulnerabilities from one web site or server to all other sites and servers that use the same certificate (even when the underlying private keys are different).

        </li>
        <br /><br />

        </p>

        <p id="reliableCA">
        <li> <font size="3"><strong>Obtain Certificates from a Reliable CA</strong></font> <br /> <br />

          Select a Certification Authority (CA) that is reliable and serious about its certificate business and security. Consider the following criteria when selecting your CA: <br /> <br />

          <b>Security posture </b> <span class="green">All CAs undergo regular audits, but some are more serious about security than others.</span> Figuring out which ones are better in this respect is not easy, but one option is to examine their security history, and, more important, how they have reacted to compromises and if they have learned from their mistakes. <br /> <br />

          <b>Business focus</b> CAs whose activities constitute a substantial part of their business have everything to lose if something goes terribly wrong, and they probably won’t neglect their certificate division by chasing potentially more lucrative opportunities elsewhere. <br /> <br />

          <b>Services offered</b> At a minimum, your selected CA should provide support for both Certificate Revocation List (CRL) and Online Certificate Status Protocol (OCSP) revocation methods, with rock-solid network availability and performance. Many sites are happy with domain-validated certificates, but you also should consider if you'll ever require Extended Validation (EV) certificates. In either case, you should have a choice of public key algorithm. Most web sites use RSA today, but ECDSA may become important in the future because of its performance advantages. <br /> <br />

          <b>Certificate management options</b> If you need a large number of certificates and operate in a complex environment, choose a CA that will give you good tools to manage them. <br /> <br />

          <b>Support</b> Choose a CA that will give you good support if and when you need it. <br /> <br />
          <blockquote>
          <strong>Note</strong>

          For best results, acquire your certificates well in advance and at least one week before deploying them to production. This practice (1) helps avoid certificate warnings for some users who don't have the correct time on their computers and (2) helps avoid failed revocation checks with CAs who need extra time to propagate new certificates as valid to their OCSP responders. Over time, try to extend this "warm-up" period to 1-3 months. Similarly, don't wait until your certificates are about to expire to replace them. Leaving an extra several months there would similarly help with people whose clocks are incorrect in the other direction.
          </blockquote>

        </li>

        </p>

        <p id="signature_algo">
        <br /><br />
        <li> <font size="3"><strong>Use Strong Certificate Signature Algorithms</strong></font> <br /> <br />
          Certificate security depends <br />
          (1) on the strength of the private key that was used to sign the certificate and <br />
          (2) the strength of the hashing function used in the signature. Until recently, most certificates relied on the SHA1 hashing function, which is now considered insecure. <br />
          <blockquote>
          As of January 2016, you shouldn't be able to get a SHA1 certificate from a public CA. The existing SHA1 certificates will continue to work (with warnings in some browsers), but only until the end of 2016.
          </blockquote>

          <a href="pki.html#findsig">How do I know the Signature that I am using in my certificate?</a>
        </li>
          </p>

          <p id="cert_chain">
        <br /><br />
        <li> <font size="3"><strong>Use Complete Certificate Chains</strong></font> <br /> <br />
          In most deployments, <span class="green">the server certificate alone is insufficient; two or more certificates are needed to build a complete chain of trust.</span> A common configuration problem occurs when deploying a server with a valid certificate, but without all the necessary intermediate certificates. To avoid this situation, simply use all the certificates provided to you by your CA. <br /> <br />

          <span class="green">An invalid certificate chain effectively renders the server certificate invalid and results in browser warnings. </span> In practice, this problem is sometimes difficult to diagnose because some browsers can reconstruct incomplete chains and some can’t. All browsers tend to cache and reuse intermediate certificates.
        </li>
        </p>
        </ul>
        </p>
         </div>
      </div>


<!--       <div class="row" style="margin-top:5vw;border-top:1px solid #4f4f4f;">
        <div id="relatedArticles" class="col-md-6 col-sm-6 col-xs-6">
          <h3>Further Reading</h3>
	          <ul>
			  <li><a href=https://docs.python.org/2/library/ssl.html>Python SSL/TLS Library</a></li>
			  <li><a href=https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet>OWASP Cheat Sheet for TLS</a></li>
			  <li><a href=https://www.feistyduck.com/books/bulletproof-ssl-and-tls/>Book:- Understanding SSL, TLS and PKI</a></li>
			  <li><a href=https://datatracker.ietf.org/doc/rfc7525/?include_text=1>RFC for secure use of SSL, TLS and DTLS</a></li>
			  </ul>
        </div>

        <div id="relatedArticles" class="col-md-6 col-sm-6 col-xs-6">
          <h3>Related Articles</h3>
	          <ul>
			  <li><a href=https://docs.python.org/2/library/ssl.html>Python SSL/TLS Library</a></li>
			  <li><a href=https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet>OWASP Cheat Sheet for TLS</a></li>
			  <li><a href=https://www.feistyduck.com/books/bulletproof-ssl-and-tls/>Book:- Understanding SSL, TLS and PKI</a></li>
			  <li><a href=https://datatracker.ietf.org/doc/rfc7525/?include_text=1>RFC for secure use of SSL, TLS and DTLS</a></li>
			  </ul>
        </div>
      </div> -->


      <div class="footerfix"></div>
      <footer class="footer">© 2018 Important legal stuff and/or links to usage restrictions etc.
      </footer>
    </div>

  </body>
</html>
